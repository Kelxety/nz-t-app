<div class="grid grid-cols-3 gap-4 items-center">
    <div class="col-span-2">
        <nz-descriptions nzBordered nzSize="middle">
            <nz-descriptions-item nzTitle="Product Code">{{itemDtls.subitemCode | nzSafeNull:
                '-'}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Product" nzSpan="2">{{itemDtls.subitemName}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Description" nzSpan="3">{{itemDtls?.scmItem?.itemDescription | nzSafeNull:
                '-'}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Category">{{itemDtls?.scmItem?.scmItemCategory?.catName | nzSafeNull:
                '-'}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Brand">{{itemDtls.brandName | nzSafeNull: '-'}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Unit">{{itemDtls.scmUnit.unitName}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Quantity">{{this.totalBalanceQty() | nzSafeNull: '-'}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Balance Qty.">
                <p class="text-red-500 font-bold">{{this.totalBal()}}</p>
            </nz-descriptions-item>
        </nz-descriptions>

        <nz-descriptions nzBordered nzLayout="vertical">
            <nz-descriptions-item nzTitle="Cost">{{itemDtls.cost | currency : 'PHP'}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Markup">{{itemDtls.markup}}</nz-descriptions-item>
            <nz-descriptions-item nzTitle="Price">{{itemDtls.price | currency : 'PHP'}}</nz-descriptions-item>
        </nz-descriptions>
    </div>

    <div class=" justify-center items-center space-y-2">
        <nz-select [(ngModel)]="selectedValue" (ngModelChange)="loadLedger()" #selectItem nzShowSearch
            nzPlaceHolder="Select item" id="selectedItem" class=" float-right w-[50%] mb-2">
            <nz-option *ngFor="let o of listOfItem" [nzValue]="o" [nzLabel]="o.whName"></nz-option>
        </nz-select>
        <nz-table #groupingTable [nzData]="summaryData()" [nzShowPagination]="false" nzBordered nzSize="middle"
            [nzScroll]="{ x: '500px', y: '230px' }">
            <thead>
                <tr>
                    <th rowspan="4" nzLeft>SUMMARY</th>
                    <th rowspan="4" nzAlign="center">QUANTITY</th>
                    <th colspan="2">AMOUNT BASED</th>
                </tr>
                <tr>
                    <th rowspan="3" nzAlign="right">COST/qty.</th>
                    <th rowspan="3" nzAlign="right">PRICE/qty.</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let data of groupingTable.data">
                    <td nzLeft>{{data.summary}}</td>
                    <td nzAlign="center">{{data.quantity}}</td>
                    <td nzAlign="right">{{data.cost | currency : 'PHP'}}</td>
                    <td nzAlign="right">{{data.price | currency : 'PHP'}}</td>
                </tr>
            </tbody>
        </nz-table>
    </div>
</div>



<div class="mt-2" *ngIf="!model.loading; else isLoading">
    <nz-table nzShowSizeChanger #fixedTable [nzData]="model.filteredList" [nzShowPagination]="false"
        (nzCurrentPageDataChange)="onCurrentPageDataChange($event)">
        <thead>
            <tr>
                <th nzWidth="210px">Warehouse</th>
                <th nzWidth="210px">Date</th>
                <th>REF #</th>
                <th>Transaction</th>
                <th>Remarks</th>
                <th nzWidth="110px">IN (+)</th>
                <th nzWidth="110px">OUT (-)</th>
                <th nzWidth="110px">RUNNING BALANCE</th>

            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let data of fixedTable.data">
                <td nzEllipsis>{{ data?.scmWarehouse.whName }}</td>
                <td nzEllipsis>{{ data?.entryDate|
                    date : 'LLL/dd/YYYY' }}</td>
                <td nzEllipsis>{{ data?.refno }}</td>
                <td nzEllipsis>{{ data?.scmLedgerCode.ledgerName }} ({{data.scmLedgerCode.ledgerCode}})</td>
                <td nzEllipsis>{{ data?.remarks }}</td>
                <td nzEllipsis>{{ data.scmLedgerCode.ledgerFlag === 'IN' ? data.qty : '-' }}</td>
                <td nzEllipsis>{{ data.scmLedgerCode.ledgerFlag === 'OUT' ? data?.qty : '-' }}</td>
                <td nzEllipsis>{{ data.scmLedgerCode.ledgerFlag === 'IN' ? data.qty : data.scmLedgerCode.ledgerFlag ===
                    'OUT' ? (itemDtls.balanceQty - data.qty) : '-'}}</td>
            </tr>
        </tbody>
    </nz-table>

</div>


<ng-template #suffixIconSearch>
    <span nz-icon nzType="search"></span>
</ng-template>

<ng-template #options>
    <div nz-space nzAlign="start">
        <nz-input-group *nzSpaceItem [nzSuffix]="suffixIconSearch">
            <input type="text" nz-input placeholder="Search..." name="search" [ngModel]="search" />
        </nz-input-group>
        <nz-button-group *nzSpaceItem>
            <button class="pointer" nz-button style="padding-left: 8px; padding-right: 8px" nzTooltipTitle="Add "
                nzTooltipPlacement="topLeft" nz-tooltip>
                <span nz-icon nzType="plus" nzTheme="outline"></span>
            </button>
            <button class="pointer" nz-button style="padding-left: 8px; padding-right: 8px" nzTooltipTitle="Reload"
                nzTooltipPlacement="topLeft" nz-tooltip>
                <span nz-icon nzType="reload" nzTheme="outline"></span>
            </button>
        </nz-button-group>
    </div>
</ng-template>

<ng-template #isLoading>
    <div style="padding: 24px">
        <nz-skeleton [nzActive]="true"></nz-skeleton>
        <nz-skeleton [nzActive]="true"></nz-skeleton>
    </div>
</ng-template>

<!-- <ng-template [nzModalTitle]>
    <nz-select [(ngModel)]="selectedValue" (ngModelChange)="loadLedger()" #selectItem nzShowSearch
        nzPlaceHolder="Select item" id="selectedItem">
        <nz-option *ngFor="let o of listOfItem" [nzValue]="o" [nzLabel]="o.whName"></nz-option>
    </nz-select>
</ng-template> -->